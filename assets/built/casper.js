function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}!function(o){"use strict";o.fn.fitVids=function(e){var r={customSelector:null,ignore:null};if(!document.getElementById("fit-vids-style")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("div");n.innerHTML='<p>x</p><style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>',t.appendChild(n.childNodes[1])}return e&&o.extend(r,e),this.each(function(){var e=['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]','iframe[src*="kickstarter.com"][src*="video.html"]',"object","embed"];r.customSelector&&e.push(r.customSelector);var n=".fitvidsignore";r.ignore&&(n=n+", "+r.ignore);var t=o(this).find(e.join(","));(t=(t=t.not("object object")).not(n)).each(function(){var e=o(this);if(!(0<e.parents(n).length||"embed"===this.tagName.toLowerCase()&&e.parent("object").length||e.parent(".fluid-width-video-wrapper").length)){e.css("height")||e.css("width")||!isNaN(e.attr("height"))&&!isNaN(e.attr("width"))||(e.attr("height",9),e.attr("width",16));var t=("object"===this.tagName.toLowerCase()||e.attr("height")&&!isNaN(parseInt(e.attr("height"),10))?parseInt(e.attr("height"),10):e.height())/(isNaN(parseInt(e.attr("width"),10))?e.width():parseInt(e.attr("width"),10));if(!e.attr("name")){var r="fitvid"+o.fn.fitVids._count;e.attr("name",r),o.fn.fitVids._count++}e.wrap('<div class="fluid-width-video-container"><div class="fluid-width-video-wrapper"></div></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*t+"%"),e.removeAttr("height").removeAttr("width")}})})},o.fn.fitVids._count=0}(window.jQuery||window.Zepto),window.onload=function(){},require(["app/lib/ready","app/config","app/i18n","app/api","app/isso","app/count","app/dom","app/text/css","app/text/svg","app/jade"],function(e,n,o,i,l,a,s,u,t,r){"use strict";var c,d;function f(){if(c=s("#isso-thread"),d=s.new("h4"),n.css&&null===s("style#isso-style")){var e=s.new("style");e.id="isso-style",e.type="text/css",e.textContent=u.inline,s("head").append(e)}if(a(),null===c)return console.log("abort, #isso-thread is missing");if(n.feed){var t=s.new("a",o.translate("atom-feed")),r=s.new("span.isso-feedlink");t.href=i.feed(c.getAttribute("data-isso-id")),r.appendChild(t),c.append(r)}c.append(d),c.append(new l.Postbox(null)),c.append('<div id="isso-root"></div>')}function p(){0!=s("#isso-root").length&&(s("#isso-root").textContent="",i.fetch(c.getAttribute("data-isso-id")||location.pathname,n["max-comments-top"],n["max-comments-nested"]).then(function(e){if(0!==e.total_replies){var t=0,r=e.total_replies;e.replies.forEach(function(e){l.insert(e,!1),e.created>t&&(t=e.created),r+=e.total_replies}),d.textContent=o.pluralize("num-comments",r),0<e.hidden_replies&&l.insert_loader(e,t),0<window.location.hash.length&&window.location.hash.match("^#isso-[0-9]+$")&&s(window.location.hash).scrollIntoView()}else d.textContent=o.translate("no-comments")},function(e){console.log(e)}))}r.set("conf",n),r.set("i18n",o.translate),r.set("pluralize",o.pluralize),r.set("svg",t),e(function(){f(),p()}),window.Isso={init:f,fetchComments:p}}),function(e,t){t.addEventListener("DOMContentLoaded",function(){t.querySelectorAll(".kg-gallery-image img").forEach(function(e){var t=e.closest(".kg-gallery-image"),r=e.attributes.width.value/e.attributes.height.value;t.style.flex=r+" 1 0%"})})}(window,document),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.fuzzysort=t()}(this,function(){var E="undefined"!=typeof require&&"undefined"==typeof window,r=new Map,n=new Map,j=[];j.total=0;var b=[],k=[];function t(){r.clear(),n.clear(),b=[],k=[]}function P(e){for(var t=-9007199254740991,r=e.length-1;0<=r;--r){var n=e[r];if(null!==n){var o=n.score;t<o&&(t=o)}}return-9007199254740991===t?null:t}function q(e,t){var r=e[t];if(void 0!==r)return r;var n=t;Array.isArray(t)||(n=t.split("."));for(var o=n.length,i=-1;e&&++i<o;)e=e[n[i]];return e}function N(e){return"object"==typeof e}var o=function(){var i=[],l=0,e={};function t(){for(var e=0,t=i[e],r=1;r<l;){var n=r+1;e=r,n<l&&i[n].score<i[r].score&&(e=n),i[e-1>>1]=i[e],r=1+(e<<1)}for(var o=e-1>>1;0<e&&t.score<i[o].score;o=(e=o)-1>>1)i[e]=i[o];i[e]=t}return e.add=function(e){var t=l;i[l++]=e;for(var r=t-1>>1;0<t&&e.score<i[r].score;r=(t=r)-1>>1)i[t]=i[r];i[t]=e},e.poll=function(){if(0!==l){var e=i[0];return i[0]=i[--l],t(),e}},e.peek=function(e){if(0!==l)return i[0]},e.replaceTop=function(e){i[0]=e,t()},e},x=o();return function e(L){var I={single:function(e,t,r){return e?(N(e)||(e=I.getPreparedSearch(e)),t?(N(t)||(t=I.getPrepared(t)),((r&&void 0!==r.allowTypo?r.allowTypo:!L||void 0===L.allowTypo||L.allowTypo)?I.algorithm:I.algorithmNoTypo)(e,t,e[0])):null):null},go:function(e,t,r){if(!e)return j;var n=(e=I.prepareSearch(e))[0],o=r&&r.threshold||L&&L.threshold||-9007199254740991,i=r&&r.limit||L&&L.limit||9007199254740991,l=(r&&void 0!==r.allowTypo?r.allowTypo:!L||void 0===L.allowTypo||L.allowTypo)?I.algorithm:I.algorithmNoTypo,a=0,s=0,u=t.length;if(r&&r.keys)for(var c=r.scoreFn||P,d=r.keys,f=d.length,p=u-1;0<=p;--p){for(var h=t[p],g=new Array(f),v=f-1;0<=v;--v)(w=q(h,y=d[v]))?(N(w)||(w=I.getPrepared(w)),g[v]=l(e,w,n)):g[v]=null;g.obj=h;var m=c(g);null!==m&&(m<o||(g.score=m,a<i?(x.add(g),++a):(++s,m>x.peek().score&&x.replaceTop(g))))}else if(r&&r.key){var y=r.key;for(p=u-1;0<=p;--p)(w=q(h=t[p],y))&&(N(w)||(w=I.getPrepared(w)),null!==(b=l(e,w,n))&&(b.score<o||(b={target:b.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:b.score,indexes:b.indexes,obj:h},a<i?(x.add(b),++a):(++s,b.score>x.peek().score&&x.replaceTop(b)))))}else for(p=u-1;0<=p;--p){var w,b;(w=t[p])&&(N(w)||(w=I.getPrepared(w)),null!==(b=l(e,w,n))&&(b.score<o||(a<i?(x.add(b),++a):(++s,b.score>x.peek().score&&x.replaceTop(b)))))}if(0===a)return j;var k=new Array(a);for(p=a-1;0<=p;--p)k[p]=x.poll();return k.total=a+s,k},goAsync:function(C,T,_){var S=!1,e=new Promise(function(p,h){if(!C)return p(j);var g=(C=I.prepareSearch(C))[0],v=o(),m=T.length-1,y=_&&_.threshold||L&&L.threshold||-9007199254740991,w=_&&_.limit||L&&L.limit||9007199254740991,b=(_&&void 0!==_.allowTypo?_.allowTypo:!L||void 0===L.allowTypo||L.allowTypo)?I.algorithm:I.algorithmNoTypo,k=0,x=0;function A(){if(S)return h("canceled");var e=Date.now();if(_&&_.keys)for(var t=_.scoreFn||P,r=_.keys,n=r.length;0<=m;--m){for(var o=T[m],i=new Array(n),l=n-1;0<=l;--l)(u=q(o,s=r[l]))?(N(u)||(u=I.getPrepared(u)),i[l]=b(C,u,g)):i[l]=null;i.obj=o;var a=t(i);if(null!==a&&!(a<y)&&(i.score=a,k<w?(v.add(i),++k):(++x,a>v.peek().score&&v.replaceTop(i)),m%1e3==0&&10<=Date.now()-e))return void(E?setImmediate(A):setTimeout(A))}else if(_&&_.key){for(var s=_.key;0<=m;--m)if((u=q(o=T[m],s))&&(N(u)||(u=I.getPrepared(u)),null!==(c=b(C,u,g))&&!(c.score<y)&&(c={target:c.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:c.score,indexes:c.indexes,obj:o},k<w?(v.add(c),++k):(++x,c.score>v.peek().score&&v.replaceTop(c)),m%1e3==0&&10<=Date.now()-e)))return void(E?setImmediate(A):setTimeout(A))}else for(;0<=m;--m){var u,c;if((u=T[m])&&(N(u)||(u=I.getPrepared(u)),null!==(c=b(C,u,g))&&!(c.score<y)&&(k<w?(v.add(c),++k):(++x,c.score>v.peek().score&&v.replaceTop(c)),m%1e3==0&&10<=Date.now()-e)))return void(E?setImmediate(A):setTimeout(A))}if(0===k)return p(j);for(var d=new Array(k),f=k-1;0<=f;--f)d[f]=v.poll();d.total=k+x,p(d)}E?setImmediate(A):A()});return e.cancel=function(){S=!0},e},highlight:function(e,t,r){if(null===e)return null;void 0===t&&(t="<b>"),void 0===r&&(r="</b>");for(var n="",o=0,i=!1,l=e.target,a=l.length,s=e.indexes,u=0;u<a;++u){var c=l[u];if(s[o]===u){if(i||(i=!0,n+=t),++o===s.length){n+=c+r+l.substr(u+1);break}}else i&&(i=!1,n+=r);n+=c}return n},prepare:function(e){if(e)return{target:e,_targetLowerCodes:I.prepareLowerCodes(e),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(e){if(e)return{target:e,_targetLowerCodes:I.prepareLowerCodes(e),_nextBeginningIndexes:I.prepareNextBeginningIndexes(e),score:null,indexes:null,obj:null}},prepareSearch:function(e){if(e)return I.prepareLowerCodes(e)},getPrepared:function(e){if(999<e.length)return I.prepare(e);var t=r.get(e);return void 0!==t||(t=I.prepare(e),r.set(e,t)),t},getPreparedSearch:function(e){if(999<e.length)return I.prepareSearch(e);var t=n.get(e);return void 0!==t||(t=I.prepareSearch(e),n.set(e,t)),t},algorithm:function(e,t,r){for(var n=t._targetLowerCodes,o=e.length,i=n.length,l=0,a=0,s=0,u=0;;){if(r===n[a]){if(b[u++]=a,++l===o)break;r=e[0===s?l:s===l?l+1:s===l-1?l-1:l]}if(i<=++a)for(;;){if(l<=1)return null;if(0===s){if(r===e[--l])continue;s=l}else{if(1===s)return null;if((r=e[1+(l=--s)])===e[l])continue}a=b[(u=l)-1]+1;break}}var c=l=0,d=!1,f=0,p=t._nextBeginningIndexes;null===p&&(p=t._nextBeginningIndexes=I.prepareNextBeginningIndexes(t.target));var h=a=0===b[0]?0:p[b[0]-1];if(a!==i)for(;;)if(i<=a){if(l<=0){if(o-2<++c)break;if(e[c]===e[c+1])continue;a=h;continue}--l,a=p[k[--f]]}else if(e[0===c?l:c===l?l+1:c===l-1?l-1:l]===n[a]){if(k[f++]=a,++l===o){d=!0;break}++a}else a=p[a];if(d)var g=k,v=f;else g=b,v=u;for(var m=0,y=-1,w=0;w<o;++w)y!==(a=g[w])-1&&(m-=a),y=a;for(d?0!==c&&(m+=-20):(m*=1e3,0!==s&&(m+=-20)),m-=i-o,t.score=m,t.indexes=new Array(v),w=v-1;0<=w;--w)t.indexes[w]=g[w];return t},algorithmNoTypo:function(e,t,r){for(var n=t._targetLowerCodes,o=e.length,i=n.length,l=0,a=0,s=0;;){if(r===n[a]){if(b[s++]=a,++l===o)break;r=e[l]}if(i<=++a)return null}var u=!1,c=l=0,d=t._nextBeginningIndexes;if(null===d&&(d=t._nextBeginningIndexes=I.prepareNextBeginningIndexes(t.target)),(a=0===b[0]?0:d[b[0]-1])!==i)for(;;)if(i<=a){if(l<=0)break;--l,a=d[k[--c]]}else if(e[l]===n[a]){if(k[c++]=a,++l===o){u=!0;break}++a}else a=d[a];if(u)var f=k,p=c;else f=b,p=s;for(var h=0,g=-1,v=0;v<o;++v)g!==(a=f[v])-1&&(h-=a),g=a;for(u||(h*=1e3),h-=i-o,t.score=h,t.indexes=new Array(p),v=p-1;0<=v;--v)t.indexes[v]=f[v];return t},prepareLowerCodes:function(e){for(var t=e.length,r=[],n=e.toLowerCase(),o=0;o<t;++o)r[o]=n.charCodeAt(o);return r},prepareBeginningIndexes:function(e){for(var t=e.length,r=[],n=0,o=!1,i=!1,l=0;l<t;++l){var a=e.charCodeAt(l),s=65<=a&&a<=90,u=s||97<=a&&a<=122||48<=a&&a<=57,c=s&&!o||!i||!u;o=s,i=u,c&&(r[n++]=l)}return r},prepareNextBeginningIndexes:function(e){for(var t=e.length,r=I.prepareBeginningIndexes(e),n=[],o=r[0],i=0,l=0;l<t;++l)l<o?n[l]=o:(o=r[++i],n[l]=void 0===o?t:o);return n},cleanup:t,new:e};return I}()});var GhostSearch=function(){function n(e){_classCallCheck(this,n);var t={url:"",key:"",version:"v3",input:"#ghost-search-field",results:"#ghost-search-results",button:"",defaultValue:"",template:function(e){return'<a href="'+[location.protocol,"//",window.location.host].join("")+"/"+e.slug+'/">'+e.title+"</a>"},trigger:"focus",options:{keys:["title"],limit:10,threshold:-3500,allowTypo:this.check=!1},api:{resource:"posts",parameters:{limit:"all",fields:["title","slug"],filter:"",include:"",order:"",formats:"",page:""}},on:{beforeDisplay:function(){},afterDisplay:function(){},beforeFetch:function(){},afterFetch:function(){}}},r=this.mergeDeep(t,e);Object.assign(this,r),this.init()}return _createClass(n,[{key:"mergeDeep",value:function(t,r){var n=this;return t&&"object"===_typeof(t)&&!Array.isArray(t)&&null!==t&&r&&"object"===_typeof(r)&&!Array.isArray(r)&&null!==r&&Object.keys(r).forEach(function(e){r[e]&&"object"===_typeof(r[e])&&!Array.isArray(r[e])&&null!==r[e]?(t[e]||Object.assign(t,_defineProperty({},e,{})),n.mergeDeep(t[e],r[e])):Object.assign(t,_defineProperty({},e,r[e]))}),t}},{key:"fetch",value:function(){var t=this;this.on.beforeFetch();var e=new GhostContentAPI({url:this.url,key:this.key,version:this.version}),r={},n=this.api.parameters;for(var o in n)""!=n[o]&&(r[o]=n[o]);e[this.api.resource].browse(r).then(function(e){t.search(e)}).catch(function(e){console.error(e)})}},{key:"createElementFromHTML",value:function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}},{key:"displayResults",value:function(e){if(null!==document.querySelectorAll(this.results)[0].firstChild&&""!==document.querySelectorAll(this.results)[0].firstChild)for(;document.querySelectorAll(this.results)[0].firstChild;)document.querySelectorAll(this.results)[0].removeChild(document.querySelectorAll(this.results)[0].firstChild);var t=document.querySelectorAll(this.input)[0].value;""!=this.defaultValue&&(t=this.defaultValue);var r=fuzzysort.go(t,e,{keys:this.options.keys,limit:this.options.limit,allowTypo:this.options.allowTypo,threshold:this.options.threshold});for(var n in r)n<r.length&&document.querySelectorAll(this.results)[0].appendChild(this.createElementFromHTML(this.template(r[n].obj)));this.on.afterDisplay(r),this.defaultValue=""}},{key:"search",value:function(t){var r=this;if(this.on.afterFetch(t),this.check=!0,""!=this.defaultValue&&(this.on.beforeDisplay(),this.displayResults(t)),""!=this.button){var e=document.getElementById("search-btn");document.getElementById("search-form").addEventListener("submit",function(e){e.preventDefault()}),e.addEventListener("click",function(e){e.preventDefault(),r.on.beforeDisplay(),r.displayResults(t)})}else document.querySelectorAll(this.input)[0].addEventListener("keyup",function(e){r.on.beforeDisplay(),r.displayResults(t)})}},{key:"checkArgs",value:function(){return document.querySelectorAll(this.input).length?document.querySelectorAll(this.results).length?""==this.button||document.querySelectorAll(this.button).length?""==this.url?(console.log("Content API Client Library host missing. Please set the host. Must not end in a trailing slash."),!1):""!=this.key||(console.log('Content API Client Library key missing. Please set the key. Hex string copied from the "Integrations" screen in Ghost Admin.'),!1):(console.log("Button not found."),!1):(console.log("Results not found."),!1):(console.log("Input not found."),!1)}},{key:"validate",value:function(){return!!this.checkArgs()}},{key:"init",value:function(){var t=this;this.validate()&&(""!=this.defaultValue&&(document.querySelectorAll(this.input)[0].value=this.defaultValue,window.onload=function(){t.check||t.fetch()}),"focus"==this.trigger?document.querySelectorAll(this.input)[0].addEventListener("focus",function(e){t.check||t.fetch()}):"load"==this.trigger&&(window.onload=function(){t.check||t.fetch()}))}}]),n}();!function(t,r){var n=r.querySelector("link[rel=next]");if(n){var o=r.querySelector(".post-feed");if(o){var i=300,l=!1,a=!1,s=t.scrollY,u=t.innerHeight,c=r.documentElement.scrollHeight;t.addEventListener("scroll",p,{passive:!0}),t.addEventListener("resize",h),f()}}function d(){if(404===this.status)return t.removeEventListener("scroll",p),void t.removeEventListener("resize",h);this.response.querySelectorAll(".post-card").forEach(function(e){o.appendChild(r.importNode(e,!0))});var e=this.response.querySelector("link[rel=next]");e?n.href=e.href:(t.removeEventListener("scroll",p),t.removeEventListener("resize",h)),c=r.documentElement.scrollHeight,a=l=!1}function e(){if(!a)if(s+u<=c-i)l=!1;else{a=!0;var e=new t.XMLHttpRequest;e.responseType="document",e.addEventListener("load",d),e.open("GET",n.href),e.send(null)}}function f(){l||t.requestAnimationFrame(e),l=!0}function p(){s=t.scrollY,f()}function h(){u=t.innerHeight,c=r.documentElement.scrollHeight,f()}}(window,document);
//# sourceMappingURL=casper.js.map